var TOTAL_COMMENT_V2=function(){var t=void 0,e=".total-rating-form-v2",n=function(){var t=$(".list-comment-ratting.v2").data("id"),e=$(".list-comment-ratting.v2").data("map");i(),$.ajax({url:TOTAL_RATING_URL.URL_TOTAL_COMMENT_NOW,type:"GET",dataType:"html",data:{target_id:t,map:e}}).done(function(t){$(".list-comment-ratting.v2").html(t)}).always(function(){})},a=function(){$(document).on("click",".pagination_rating.rating a",function(t){i(),t.preventDefault(),$.ajax({url:$(this).attr("href"),type:"GET",dataType:"html"}).done(function(t){$(".list-comment-ratting.v2").html(t)}).always(function(){})})},i=function(t){null==t&&(t=$(".list-comment-ratting.v2")),t.append('<img style="width: 10%;margin: 0 auto;display: block;" src="theme/frontend/plugins/total_rating/theme/images/loading.svg"/>')},o=function(){$(document).on("submit",e,function(e){e.preventDefault();var n=$(this);TOTAL_RATING_VALIDATE.validateFormComment(n)&&$.ajax({url:TOTAL_RATING_URL.URL_TOTAL_COMMENT_NOW,type:$(this).attr("method"),dataType:"json",data:r(n),contentType:!1,cache:!1,processData:!1}).done(function(e){TOTAL_RATING_ALERT.alert(e.message,200==e.code?"success":"error"),function(e){$(e).find("textarea").val(null),$(e).find("[type=radio]").prop("checked",!1),l(e)&&t.resetData()}(n),m(n,e)}).fail(function(){TOTAL_RATING_ALERT.alert("Xáº£y ra lá»—i!")})}),$(document).on("click",".list-comment-ratting.v2 .item--cmt .reply",function(t){t.preventDefault();var e=$(this).next();if(0==e.length||!e.hasClass("total-rating-form-comment")){var n=$(".total-rating-form-comment").last().clone(),a=$(this).data("id");n.append('<input name="reply_id" type="hidden" value = "'+a+'" />'),n.find(".ratting-user").remove(),n.insertAfter($(this))}})},r=function(e){if(l(e))return t.buildFormData();for(var n=new FormData,a=e.serializeArray(),i=0;i<a.length;i++)n.append(a[i].name,a[i].value);return n},l=function(t){return t.hasClass("big-form")};var m=function(t,e){t.hasClass("big-form")?$(".list-comment-ratting.v2").prepend(e.html):t.parent().find(".list_result-single").prepend(e.html)},c=function(){$(document).on("click",".list-comment-ratting.v2 .item--comment .show-form--reply",function(t){t.preventDefault();var n=$(this).parents(".item--comment");if(0==n.find(e).length){var a=$(e).first().clone();a.find(".wrap-ratting").remove(),a.find(".bar-form").remove(),a.removeClass("big-form"),a.append('<input type="hidden" name="reply_to" value="'+$(this).data("id")+'" />');var o=$(this).parents(".action-comment-sigle");a.insertAfter(o)}else n.find(e).toggle();0==$(this).find(".list_result-single item--comment").length&&null==$(this).data("loaded-sub")&&($(this).data("loaded-sub",!0),function(t){var e=t.data("id"),n=t.parents(".item--comment").find(".list_result-single");i(n),$.ajax({url:TOTAL_RATING_URL.URL_TOTAL_COMMENT_SUB,type:"GET",dataType:"html",data:{target_id:e}}).done(function(t){n.html(t)}).always(function(){})}($(this)))})},s=function(){$(document).on("click",".list-comment-ratting.v2 .item--comment .like",function(t){var e=$(this),n=e.data("id");t.preventDefault(),$.ajax({url:TOTAL_RATING_URL.URL_TOTAL_COMMENT_LIKE,type:"GET",dataType:"json",data:{target_id:n}}).done(function(t){200==t.code&&e.find(".count-like").text(0==t.count?"":t.count)}).always(function(){})})};return{_:function(){$(e).length>0&&(t=$(e).TECH5S_FILE_BROWSER()[0],n(),a(),o(),c(),s())}}}();TOTAL_COMMENT_V2._();var TOTAL_SUPER_COMMENT=function(){var t=void 0,e=".comment-no-ratting.super",n=function(){var t=$(".list-comment-viewer.super").data("id"),e=$(".list-comment-viewer.super").data("map");i(),$.ajax({url:TOTAL_RATING_URL.URL_TOTAL_SUPER_COMMENT,type:"GET",dataType:"html",data:{target_id:t,map:e}}).done(function(t){$(".list-comment-viewer.super .list-item-viewer").html(t)}).always(function(){})},a=function(){$(document).on("click",".pagination_rating.rating.super a",function(t){i(),t.preventDefault(),$.ajax({url:$(this).attr("href"),type:"GET",dataType:"html"}).done(function(t){$(".list-comment-viewer.super").html(t)}).always(function(){})})},i=function(t){null==t&&(t=$(".list-comment-viewer.super .list-item-viewer")),t.append('<img style="width: 10%;margin: 0 auto;display: block;" src="theme/frontend/plugins/total_rating/theme/images/loading.svg"/>')},o=function(t){return t.hasClass("big-form")},r=function(e){if(o(e))return t.buildFormData();for(var n=new FormData,a=e.serializeArray(),i=0;i<a.length;i++)n.append(a[i].name,a[i].value);return n},l=function(){$(document).on("click",".item-comment-head .action-comment-sigle .show-form--reply",function(t){t.preventDefault();var n=$(this).parents(".action-comment-sigle"),a=n.next();if(0==a.length||"FORM"!=a.prop("tagName")){var o=$(e).first().clone(),r=$(this).data("id");o.removeClass("big-form"),o.append('<input name="reply_to" type="hidden" value = "'+r+'" />'),o.find(".bar-form").remove(),o.insertAfter(n)}var l=n.parents(".item-comment-head");(o=l.find(e)).toggle(),0==l.find(".block--result .item-comment-lv").length&&null==$(this).data("loaded-sub")&&($(this).data("loaded-sub",!0),function(t){var e=t.data("id"),n=t.parents(".item-comment-head").find(".block--result");i(n),$.ajax({url:TOTAL_RATING_URL.URL_TOTAL_SUPER_COMMENT_SUB,type:"GET",dataType:"html",data:{target_id:e}}).done(function(t){n.html(t)}).always(function(){})}($(this)))})},m=function(){$(document).on("submit",e,function(e){e.preventDefault();var n=$(this);TOTAL_RATING_VALIDATE.validateFormComment(n)&&$.ajax({url:TOTAL_RATING_URL.URL_TOTAL_SUPER_COMMENT,type:$(this).attr("method"),dataType:"json",data:r(n),contentType:!1,cache:!1,processData:!1}).done(function(e){TOTAL_RATING_ALERT.alert(e.message,200==e.code?"success":"error"),function(e){$(e).find("textarea").val(null),$(e).find("[type=radio]").prop("checked",!1),o(e)&&t.resetData()}(n),c(n,e)}).fail(function(){TOTAL_RATING_ALERT.alert("Xáº£y ra lá»—i!")})})},c=function(t,e){o(t)?$(".list-comment-viewer.super").prepend(e.html):t.parent().find(">.block--result").prepend(e.html)};var s=function(){$(document).on("click",".item-comment-head .action-comment-sigle .like",function(t){t.preventDefault();var e=$(this),n=e.data("id");$.ajax({url:TOTAL_RATING_URL.URL_TOTAL_SUPER_COMMENT_LIKE,type:"GET",dataType:"json",data:{target_id:n}}).done(function(t){200==t.code&&e.find(".count-like").text(0==t.count?"":t.count)}).always(function(){})})};return{_:function(){$(e).length>0&&(t=$(e).TECH5S_FILE_BROWSER()[0],n(),a(),m(),s(),l())}}}();TOTAL_SUPER_COMMENT._();